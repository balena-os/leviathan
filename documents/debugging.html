<!DOCTYPE html><html class="default" lang="en"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>debugging | Leviathan</title><meta name="description" content="Documentation for Leviathan"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">Leviathan</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../modules.html">Leviathan</a></li><li><a href="debugging.html">debugging</a></li></ul></div><div class="tsd-panel tsd-typography"><a id="md:frequently-asked-questions" class="tsd-anchor"></a><h1 class="tsd-anchor-link">Frequently Asked Questions<a href="#md:frequently-asked-questions" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><a id="md:table-of-contents" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Table of Contents<a href="#md:table-of-contents" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><a href="#md:finding-the-right-autokit">Finding the right autokit</a></li>
<li><a href="#md:checking-if-autokit-is-ready-to-run-tests">Checking if Autokit is ready to run tests</a></li>
<li><a href="#md:config-issues-when-running-tests">Config issues when running tests</a></li>
<li><a href="#md:flashing-issues">Flashing issues</a></li>
<li><a href="#md:manually-interacting-with-the-dut">Manually interacting with the DUT</a></li>
<li><a href="#md:recovering-the-autokit">Recovering the Autokit</a></li>
<li><a href="#md:connection-issues-between-leviathan-and-devices-under-test">Connection issues between Leviathan and devices under test?</a></li>
<li><a href="#md:write-new-tests-or-contribute-to-an-existing-test-suite">Write new tests or contribute to an existing test suite?</a></li>
<li><a href="#md:debugging-tests-interactively-in-leviathan">Debugging tests interactively in Leviathan</a></li>
</ul>
<a id="md:finding-the-right-autokit" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Finding the right autokit<a href="#md:finding-the-right-autokit" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>If you have provided a fleet as your <code>workers</code> configuration, then Leviathan will search that fleet for an available autokit connected to the device type you want to run tests on. For example, check out the config below shortenned for brevity:</p>
<pre><code class="js"><span class="hl-1">    {</span><br/><span class="hl-1">      </span><span class="hl-10">deviceType</span><span class="hl-1">: </span><span class="hl-2">&quot;raspberrypi3&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-10">suite</span><span class="hl-1">: </span><span class="hl-2">`</span><span class="hl-6">${</span><span class="hl-7">__dirname</span><span class="hl-6">}</span><span class="hl-2">/../suites/os`</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-10">config</span><span class="hl-1">: {</span><br/><span class="hl-1">        </span><span class="hl-10">balenaApiKey</span><span class="hl-1">: </span><span class="hl-2">&#39;&#39;</span><span class="hl-1">, </span><br/><span class="hl-1">        </span><span class="hl-10">balenaApiUrl</span><span class="hl-1">: </span><span class="hl-2">&#39;balena-cloud.com&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-3">...</span><br/><span class="hl-1">      },</span><br/><span class="hl-1">      </span><span class="hl-10">image</span><span class="hl-1">: </span><span class="hl-8">false</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-10">workers</span><span class="hl-1">: {</span><br/><span class="hl-1">        </span><span class="hl-10">balenaApplication</span><span class="hl-1">: </span><span class="hl-2">&#39;balena/testbot-rig&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-10">apiKey</span><span class="hl-1">: </span><span class="hl-2">&quot;&quot;</span><span class="hl-1">, </span><span class="hl-11">// BM</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }</span>
</code><button type="button">Copy</button></pre>

<p>Using this <code>config.js</code>, we can determine that Leviathan will be searching for an available autokit with a <code>DUT: raspberrypi3</code> tag in the <code>balena/testbot-rig</code> fleet in the <code>balena-cloud.com</code> environment to run the <code>os</code> test suite. Refer to the <a href="https://balena.fibery.io/Inputs/Pattern/BalenaOS-Testing-Leviathan-Autokit-Common-Issues,-Debugging-Context-4777/anchor=Testing-Fleets-to-find-the-right-autokit--cfc31205-72f4-4315-a0dd-a8240effcd40" target="_blank" class="external">fleet list</a> to find balena's official autokit fleets used for testing.</p>
<p>Once you find the right balenaCloud fleet where autokits are provisioned, you can check the DUT tags on the devices page to see which autokits are connected to the device type you want to test on. Once identified, run your tests targetting that autokit directly by providing the Public Device URL of the autokit in the <code>workers</code> configuration. For example:</p>
<pre><code><span class="hl-1">    </span><span class="hl-10">workers</span><span class="hl-1">: [</span><span class="hl-2">&#39;https://PUBLIC-DEVICE-URL.balena-devices.com/&#39;</span><span class="hl-1">]</span>
</code><button>Copy</button></pre>

<p>This will target the test run directly to the specific autokit, bypassing the fleet search that Leviathan conducts. If the autokit is available, then Leviathan will run the tests.</p>
<a id="md:checking-if-autokit-is-ready-to-run-tests" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Checking if Autokit is ready to run tests<a href="#md:checking-if-autokit-is-ready-to-run-tests" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Testing with autokit requires several components to work together. All steps in the Getting Started guide must be completed to ensure the autokit works correctly. You can do the following steps to verify if the setup is correct.</p>
<ol>
<li>To check the availability of an autokit manually, you can run the following command:</li>
</ol>
<pre><code><span class="hl-7">$</span><span class="hl-1"> </span><span class="hl-7">curl</span><span class="hl-1"> </span><span class="hl-3">-</span><span class="hl-9">X</span><span class="hl-1"> </span><span class="hl-9">POST</span><span class="hl-1"> </span><span class="hl-9">PUBLIC</span><span class="hl-3">-</span><span class="hl-9">DEVICE</span><span class="hl-3">-</span><span class="hl-9">URL</span><span class="hl-3">-</span><span class="hl-9">OF</span><span class="hl-3">-</span><span class="hl-9">AUTOKIT</span><span class="hl-3">/</span><span class="hl-7">state</span>
</code><button>Copy</button></pre>

<ol start="2">
<li>If the state is IDLE, we can run a short diagnostics test to see if the autokit works correctly. Run the Leviathan e2e test described in this section <a href="quickstart.quickstart_autokit.html">Start your first test run</a> on the autokit you want to verify. After completing the Leviathan prerequisites listed above the section, you can create your config.js and add the Public Device URL in the <code>workers</code> section.</li>
</ol>
<p>If the test completes without any errors, then the autokit should be ready to run the tests.</p>
<a id="md:config-issues-when-running-tests" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Config issues when running tests<a href="#md:config-issues-when-running-tests" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><pre><code class="sh"><span class="hl-0">Invalid</span><span class="hl-1"> </span><span class="hl-2">device</span><span class="hl-1"> </span><span class="hl-2">type:</span><span class="hl-1"> </span><span class="hl-3">&lt;</span><span class="hl-2">device-type-withou</span><span class="hl-1">t</span><span class="hl-3">&gt;</span>
</code><button type="button">Copy</button></pre>

<p>If you see this, ensure the contract for your device type is available in the <code>contracts</code> submodule in <code>leviathan/core/contracts/contracts/hw.device-type</code>.</p>
<pre><code><span class="hl-9">OS</span><span class="hl-1"> </span><span class="hl-7">image</span><span class="hl-1"> </span><span class="hl-7">not</span><span class="hl-1"> </span><span class="hl-10">found</span><span class="hl-1">: </span><span class="hl-10">ENOENT</span><span class="hl-1">: </span><span class="hl-7">no</span><span class="hl-1"> </span><span class="hl-7">such</span><span class="hl-1"> </span><span class="hl-7">file</span><span class="hl-1"> </span><span class="hl-7">or</span><span class="hl-1"> </span><span class="hl-7">directory</span><span class="hl-1">, </span><span class="hl-7">access</span><span class="hl-1"> </span><span class="hl-2">&#39;/usr/src/app/workspace/image.img.gz&#39;</span>
</code><button>Copy</button></pre>

<p>Ensure your OS image is stored in the <code>leviathan/workspace</code> directory.</p>
<pre><code><span class="hl-7">No</span><span class="hl-1"> </span><span class="hl-7">workers</span><span class="hl-1"> </span><span class="hl-7">found</span><span class="hl-1"> </span><span class="hl-7">for</span><span class="hl-1"> </span><span class="hl-10">deviceType</span><span class="hl-1">: </span><span class="hl-9">DEVICETYPE</span><span class="hl-3">-</span><span class="hl-9">SLUG</span>
</code><button>Copy</button></pre>

<p>No device could be found for this device type slug in the Autokit fleet you specified. There could be several reasons for this error in order to resolve it:</p>
<ol>
<li>The wrong fleet or device type was being targeted. Check the test configuration present in the test logs.</li>
<li>If not, check the balenaCloud fleet and check the <code>DUT</code> tag of the autokit devices in the fleet containing the device type slug. If you don't find a <code>DUT</code> tag matching the slug, then the worker doesn't exist.</li>
<li>If you find a device, check the state of the autokit by running the following command.</li>
</ol>
<pre><code><span class="hl-7">$</span><span class="hl-1"> </span><span class="hl-7">curl</span><span class="hl-1"> </span><span class="hl-3">-</span><span class="hl-9">X</span><span class="hl-1"> </span><span class="hl-9">POST</span><span class="hl-1"> </span><span class="hl-9">PUBLIC</span><span class="hl-3">-</span><span class="hl-9">DEVICE</span><span class="hl-3">-</span><span class="hl-9">URL</span><span class="hl-3">-</span><span class="hl-9">OF</span><span class="hl-3">-</span><span class="hl-9">AUTOKIT</span><span class="hl-3">/</span><span class="hl-7">state</span>
</code><button>Copy</button></pre>

<ol start="4">
<li>If the state is BUSY, then the device is running tests for another job.</li>
<li>If the state is IDLE, then the device is available to run the tests but is still unable to take up the test job. Refer to <a href="#md:recovering-the-autokit">Recovering the Autokit</a> section.</li>
</ol>
<a id="md:flashing-issues" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Flashing issues<a href="#md:flashing-issues" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>When the device fails during flashing - first check: has the correct <code>TESTBOT_DUT_TYPE</code> been selected (see above)?</p>
<p>If it has, we need a progression of checks.</p>
<p>First, confirm that the power control is working for the DUT. This can be done by:</p>
<pre><code class="sh"><span class="hl-0">curl</span><span class="hl-1"> </span><span class="hl-8">-X</span><span class="hl-1"> </span><span class="hl-2">POST</span><span class="hl-1"> </span><span class="hl-3">&lt;</span><span class="hl-2">autokit_i</span><span class="hl-1">p</span><span class="hl-3">&gt;</span><span class="hl-2">/dut/on</span>
</code><button type="button">Copy</button></pre>

<p>And checking that the DUT powers on. If it does, you can turn it back off with</p>
<pre><code class="sh"><span class="hl-0">curl</span><span class="hl-1"> </span><span class="hl-8">-X</span><span class="hl-1"> </span><span class="hl-2">POST</span><span class="hl-1"> </span><span class="hl-3">&lt;</span><span class="hl-2">autokit_i</span><span class="hl-1">p</span><span class="hl-3">&gt;</span><span class="hl-2">/dut/off</span>
</code><button type="button">Copy</button></pre>

<p>If that works, then check if the SD card is flashed with the image you wanted to flash to it. You can take the card out, plug it into your laptop and check.</p>
<p>If it has, then check that the DUT was booting from the SD card - if you have a serial cable attached to the autokit, you can do this:</p>
<ol>
<li>ssh into your autokit with <code>balena ssh &lt;autokit_uuid&gt; worker</code></li>
<li><code>apk add screen</code></li>
<li><code>screen &lt;serial_dev&gt; 115200</code></li>
<li>In another SSH session: <code>usbsdmux /dev/sg0 dut</code> - this will toggle the MUX to the DUT</li>
<li>Then <code>curl -X POST &lt;autokit_ip&gt;/dut/on</code> to power on the DUT</li>
<li>Check the serial output from the <code>screen</code> session. Is there anything?</li>
<li>If there isn't - then verify that the serial configuration is correct</li>
<li>If the serial configuration is correct, there should be some output on the <code>screen</code> session - you can see if it's failing to boot from the SD card or if it's booting into balena OS.</li>
<li>If it's failing to boot from SD, try another card.</li>
</ol>
<a id="md:manually-interacting-with-the-dut" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Manually interacting with the DUT<a href="#md:manually-interacting-with-the-dut" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Powering on and off can be done with:</p>
<pre><code class="sh"><span class="hl-0">curl</span><span class="hl-1"> </span><span class="hl-8">-X</span><span class="hl-1"> </span><span class="hl-2">POST</span><span class="hl-1"> </span><span class="hl-3">&lt;</span><span class="hl-2">autokit_i</span><span class="hl-1">p</span><span class="hl-3">&gt;</span><span class="hl-2">/dut/on</span><br/><span class="hl-0">curl</span><span class="hl-1"> </span><span class="hl-8">-X</span><span class="hl-1"> </span><span class="hl-2">POST</span><span class="hl-1"> </span><span class="hl-3">&lt;</span><span class="hl-2">autokit_i</span><span class="hl-1">p</span><span class="hl-3">&gt;</span><span class="hl-2">/dut/off</span>
</code><button type="button">Copy</button></pre>

<p>You can manually flash the DUT outside of the test suite with an image of your choice with:</p>
<pre><code class="sh"><span class="hl-0">curl</span><span class="hl-1"> </span><span class="hl-8">--data-binary</span><span class="hl-1"> </span><span class="hl-2">@</span><span class="hl-3">&lt;</span><span class="hl-2">your</span><span class="hl-1"> </span><span class="hl-2">image</span><span class="hl-1"> (must </span><span class="hl-2">be</span><span class="hl-1"> </span><span class="hl-2">.gz</span><span class="hl-1"> </span><span class="hl-2">gzipped</span><span class="hl-1">)</span><span class="hl-3">&gt;</span><span class="hl-1"> </span><span class="hl-3">&lt;</span><span class="hl-1">autokit_ip or public url</span><span class="hl-3">&gt;</span><span class="hl-1">/dut/flash</span>
</code><button type="button">Copy</button></pre>

<p>You can create a wired network for your DUT to connect to with:</p>
<pre><code class="sh"><span class="hl-0">curl</span><span class="hl-1"> </span><span class="hl-8">-X</span><span class="hl-1"> </span><span class="hl-2">POST</span><span class="hl-1"> </span><span class="hl-2">localhost/dut/network</span><span class="hl-1"> </span><span class="hl-8">-H</span><span class="hl-1"> </span><span class="hl-2">&#39;Content-Type: application/json&#39;</span><span class="hl-1"> </span><span class="hl-8">-d</span><span class="hl-1"> </span><span class="hl-2">&#39;{&quot;wired&quot;: {&quot;nat&quot;:true}}&#39;</span>
</code><button type="button">Copy</button></pre>

<p>You can create a wireless network with:</p>
<pre><code class="sh"><span class="hl-0">curl</span><span class="hl-1"> </span><span class="hl-8">-X</span><span class="hl-1"> </span><span class="hl-2">POST</span><span class="hl-1"> </span><span class="hl-2">localhost/dut/network</span><span class="hl-1"> </span><span class="hl-8">-H</span><span class="hl-1"> </span><span class="hl-2">&#39;Content-Type: application/json&#39;</span><span class="hl-1"> </span><span class="hl-8">-d</span><span class="hl-1"> </span><span class="hl-2">&#39;{&quot;wireless&quot;: {&quot;ssid&quot;:&quot;&lt;EXAMPLE SSID&gt;&quot;, &quot;psk&quot;:&quot;&lt;EXAMPLE PSK&quot;, &quot;nat&quot;: &quot;true&quot;}}&#39;</span>
</code><button type="button">Copy</button></pre>

<p>After setting up one of these networks, you can access the DUT via the autokit.</p>
<p>You can find the DUT IP address by ssh'ing into the autokit and checking the <code>dnsmasq</code> lease files, for example:</p>
<pre><code class="sh"><span class="hl-0">root@3d57642:~#</span><span class="hl-1"> </span><span class="hl-2">cat</span><span class="hl-1"> </span><span class="hl-2">/var/lib/NetworkManager/dnsmasq-enp1s0u1u4u1u1.leases</span><span class="hl-1"> </span><br/><span class="hl-0">1708607547</span><span class="hl-1"> </span><span class="hl-2">d8:3a:dd:4b:6e:0f</span><span class="hl-1"> </span><span class="hl-12">10.42.0.248</span><span class="hl-1"> </span><span class="hl-2">ef0a7ac</span><span class="hl-1"> </span><span class="hl-2">01:d8:3a:dd:4b:6e:0f</span>
</code><button type="button">Copy</button></pre>

<p>then from the autokit command line</p>
<pre><code class="sh"><span class="hl-0">ssh</span><span class="hl-1"> </span><span class="hl-12">10.42.0.248</span><span class="hl-1"> </span><span class="hl-8">-p</span><span class="hl-1"> </span><span class="hl-12">22222</span>
</code><button type="button">Copy</button></pre>

<p>You can view the live HDMI output in your browser with <code>&lt;autokit_ip or public url&gt;/dut/liveStream</code></p>
<a id="md:recovering-the-autokit" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Recovering the Autokit<a href="#md:recovering-the-autokit" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Upon starting a test, you might see the following errors, or there could be other symptoms when the autokit isn't responsive.</p>
<pre><code><span class="hl-7">Already</span><span class="hl-1"> </span><span class="hl-7">running</span><span class="hl-1"> </span><span class="hl-7">a</span><span class="hl-1"> </span><span class="hl-7">suite</span><span class="hl-1">. </span><span class="hl-7">Please</span><span class="hl-1"> </span><span class="hl-7">stop</span><span class="hl-1"> </span><span class="hl-7">it</span><span class="hl-1"> </span><span class="hl-7">or</span><span class="hl-1"> </span><span class="hl-13">try</span><span class="hl-1"> </span><span class="hl-7">again</span><span class="hl-1"> </span><span class="hl-7">later</span><span class="hl-1">.</span>
</code><button>Copy</button></pre>

<p>This means Leviathan couldn't find an available worker to run the tests on. It does that by checking each eligible worker's availability and then selecting an IDLE one if found. If the test is stuck due to an error or the testbot can't recover from a previous test run, then run the following command to restore the autokit to IDLE state safely.</p>
<pre><code><span class="hl-7">$</span><span class="hl-1"> </span><span class="hl-7">curl</span><span class="hl-1"> </span><span class="hl-3">-</span><span class="hl-9">X</span><span class="hl-1"> </span><span class="hl-9">POST</span><span class="hl-1"> </span><span class="hl-9">PUBLIC</span><span class="hl-3">-</span><span class="hl-9">DEVICE</span><span class="hl-3">-</span><span class="hl-9">URL</span><span class="hl-3">-</span><span class="hl-9">OF</span><span class="hl-3">-</span><span class="hl-9">AUTOKIT</span><span class="hl-3">/</span><span class="hl-7">teardown</span><br/><span class="hl-9">OK</span>
</code><button>Copy</button></pre>

<p>If it still doesn't work out, try performing a reboot of the autokit.</p>
<a id="md:connection-issues-between-leviathan-and-devices-under-test" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Connection issues between Leviathan and devices under test?<a href="#md:connection-issues-between-leviathan-and-devices-under-test" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Connection issues have been creating numerous problems in our testing lately. This can be due to VPN/API outages, DUT disconnecting, or the worker getting stuck. Such cases would lead to retires, connection resets, and delays that interrupt or fail the tests entirely. We are still debugging these issues on a case-by-case basis. Our goal is to make Leviathan more stable and reliable and reduce our dependence on VPN/API connections.</p>
<p>Please do log the following issues as you see them on <a href="https://github.com/balena-os/leviathan/issues/" target="_blank" class="external">https://github.com/balena-os/leviathan/issues/</a></p>
<a id="md:write-new-tests-or-contribute-to-an-existing-test-suite" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Write new tests or contribute to an existing test suite?<a href="#md:write-new-tests-or-contribute-to-an-existing-test-suite" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Leviathan is an open-source project, and we welcome contributions. If you want to add a new test suite or contribute to an existing one, start by <a href="writing_tests.html">writing your first test</a>. For reference, check the existing balenaOS operating system suite in the <a href="https://github.com/balena-os/meta-balena/tree/master/tests/suites" target="_blank" class="external">meta-balena</a> repository</p>
<a id="md:debugging-tests-interactively-in-leviathan" class="tsd-anchor"></a><h2 class="tsd-anchor-link">Debugging tests interactively in Leviathan<a href="#md:debugging-tests-interactively-in-leviathan" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>To improve workflow and write tests faster on Leviathan, the following debug options can be triggered to alter the behavior of test runs. A <code>debug</code> object can be added to the <code>config.js</code> file right with the existing suite's config. The <code>debug</code> object can also have custom options as needed by the test suite. These properties will become available during the test run and can be used to customize the test run further as required. Example of a debug object:</p>
<pre><code class="js"><span class="hl-1">    </span><span class="hl-10">debug</span><span class="hl-1">: {</span><br/><span class="hl-1">        </span><span class="hl-10">failFast</span><span class="hl-1">: </span><span class="hl-8">false</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-10">globalFailFast</span><span class="hl-1">: </span><span class="hl-8">false</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-10">preserveDownloads</span><span class="hl-1">: </span><span class="hl-8">false</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-10">unstable</span><span class="hl-1">: [</span><span class="hl-2">&quot;TITLE OF THE TEST 1&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;TITLE OF THE TEST 2&quot;</span><span class="hl-1">]</span><br/><span class="hl-1">        </span><span class="hl-10">dev</span><span class="hl-1">: </span><span class="hl-8">false</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-11">// Custom value </span><br/><span class="hl-1">        </span><span class="hl-10">CUSTOM_OPTION</span><span class="hl-1">: </span><span class="hl-2">&#39;Verycustomindeed&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span>
</code><button type="button">Copy</button></pre>

<p>The supported debug options available are as follows:</p>
<ol>
<li><code>failFast</code>: Exit the ongoing test suite if a test fails. Type: <code>Boolean</code>. Value: <code>true</code> or <code>false</code>. Default: <code>true</code>.</li>
<li><code>preserveDownloads</code>: Persist downloadeded artifacts. Type: <code>Boolean</code>. Value: <code>true</code> or <code>false</code>. Default: <code>false</code>.</li>
<li><code>globalFailFast</code>: Exit the entire ongoing test run if a test fails. Type: <code>Boolean</code>. Value: <code>true</code> or <code>false</code>. Default: <code>false</code>.</li>
<li><code>unstable</code>: Add titles of the test suite that need to be marked unstable in order to have them skipped from a test suite. Skipped tests are marked as <code>todo</code> in the test logs and <code>skipped</code> in the test results. Type: <code>Array</code>.</li>
<li><code>dev</code>: Run tests in development mode with validation and other checks toggled off. Type: <code>Boolean</code>. Value: <code>true</code> or <code>false</code>. Default: <code>false</code>.</li>
</ol>
<p>You can use <code>this.suite.options</code> to access your test suite's <code>CUSTOM_OPTION</code> property.</p>
<p>Check out the <a href="https://github.com/balena-os/leviathan/blob/master/workspace/config.example.js" target="_blank" class="external">config.example.js</a> file for a complete example.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:frequently-asked-questions"><span>Frequently <wbr/>Asked <wbr/>Questions</span></a><ul><li><a href="#md:table-of-contents"><span>Table of <wbr/>Contents</span></a></li><li><a href="#md:finding-the-right-autokit"><span>Finding the right autokit</span></a></li><li><a href="#md:checking-if-autokit-is-ready-to-run-tests"><span>Checking if <wbr/>Autokit is ready to run tests</span></a></li><li><a href="#md:config-issues-when-running-tests"><span>Config issues when running tests</span></a></li><li><a href="#md:flashing-issues"><span>Flashing issues</span></a></li><li><a href="#md:manually-interacting-with-the-dut"><span>Manually interacting with the DUT</span></a></li><li><a href="#md:recovering-the-autokit"><span>Recovering the <wbr/>Autokit</span></a></li><li><a href="#md:connection-issues-between-leviathan-and-devices-under-test"><span>Connection issues between <wbr/>Leviathan and devices under test?</span></a></li><li><a href="#md:write-new-tests-or-contribute-to-an-existing-test-suite"><span>Write new tests or contribute to an existing test suite?</span></a></li><li><a href="#md:debugging-tests-interactively-in-leviathan"><span>Debugging tests interactively in <wbr/>Leviathan</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-1"></use></svg><span>Leviathan</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base=".."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
